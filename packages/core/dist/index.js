import e from"node:process";import o from"node:os";import n from"node:tty";var t=function(e){return e.replace(/^\/|\/$/g,"")},r=new RegExp("".concat(t(/(\d+\.?\d*)/g.source),"(%|").concat(t(/(px|rem|em|vh|vw|vmin|vmax|vb|vi|ch|cm|mm|in|pt|pc|ex|%|zp)?/g.source),")?"));new RegExp("(".concat(t(r.source),"|[").concat(t(r.source),"])"));var s=function(e){return e.replace(/^\/|\/$/g,"")};const c=(e=0)=>o=>`[${o+e}m`,i=(e=0)=>o=>`[${38+e};5;${o}m`,l=(e=0)=>(o,n,t)=>`[${38+e};2;${o};${n};${t}m`,a={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],gray:[90,39],grey:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgGray:[100,49],bgGrey:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};Object.keys(a.modifier);Object.keys(a.color),Object.keys(a.bgColor);const u=function(){const e=new Map;for(const[o,n]of Object.entries(a)){for(const[o,t]of Object.entries(n))a[o]={open:`[${t[0]}m`,close:`[${t[1]}m`},n[o]=a[o],e.set(t[0],t[1]);Object.defineProperty(a,o,{value:n,enumerable:!1})}return Object.defineProperty(a,"codes",{value:e,enumerable:!1}),a.color.close="[39m",a.bgColor.close="[49m",a.color.ansi=c(),a.color.ansi256=i(),a.color.ansi16m=l(),a.bgColor.ansi=c(10),a.bgColor.ansi256=i(10),a.bgColor.ansi16m=l(10),Object.defineProperties(a,{rgbToAnsi256:{value:(e,o,n)=>e===o&&o===n?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(o/255*5)+Math.round(n/255*5),enumerable:!1},hexToRgb:{value(e){const o=/[a-f\d]{6}|[a-f\d]{3}/i.exec(e.toString(16));if(!o)return[0,0,0];let[n]=o;3===n.length&&(n=[...n].map((e=>e+e)).join(""));const t=Number.parseInt(n,16);return[t>>16&255,t>>8&255,255&t]},enumerable:!1},hexToAnsi256:{value:e=>a.rgbToAnsi256(...a.hexToRgb(e)),enumerable:!1},ansi256ToAnsi:{value(e){if(e<8)return 30+e;if(e<16)return e-8+90;let o,n,t;if(e>=232)o=(10*(e-232)+8)/255,n=o,t=o;else{const r=(e-=16)%36;o=Math.floor(e/36)/5,n=Math.floor(r/6)/5,t=r%6/5}const r=2*Math.max(o,n,t);if(0===r)return 30;let s=30+(Math.round(t)<<2|Math.round(n)<<1|Math.round(o));return 2===r&&(s+=60),s},enumerable:!1},rgbToAnsi:{value:(e,o,n)=>a.ansi256ToAnsi(a.rgbToAnsi256(e,o,n)),enumerable:!1},hexToAnsi:{value:e=>a.ansi256ToAnsi(a.hexToAnsi256(e)),enumerable:!1}}),a}();function f(o,n=(globalThis.Deno?globalThis.Deno.args:e.argv)){const t=o.startsWith("-")?"":1===o.length?"-":"--",r=n.indexOf(t+o),s=n.indexOf("--");return-1!==r&&(-1===s||r<s)}const{env:g}=e;let b;function d(n,{streamIsTTY:t,sniffFlags:r=!0}={}){const s=function(){if("FORCE_COLOR"in g)return"true"===g.FORCE_COLOR?1:"false"===g.FORCE_COLOR?0:0===g.FORCE_COLOR.length?1:Math.min(Number.parseInt(g.FORCE_COLOR,10),3)}();void 0!==s&&(b=s);const c=r?b:s;if(0===c)return 0;if(r){if(f("color=16m")||f("color=full")||f("color=truecolor"))return 3;if(f("color=256"))return 2}if("TF_BUILD"in g&&"AGENT_NAME"in g)return 1;if(n&&!t&&void 0===c)return 0;const i=c||0;if("dumb"===g.TERM)return i;if("win32"===e.platform){const e=o.release().split(".");return Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in g)return"GITHUB_ACTIONS"in g?3:["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","BUILDKITE","DRONE"].some((e=>e in g))||"codeship"===g.CI_NAME?1:i;if("TEAMCITY_VERSION"in g)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(g.TEAMCITY_VERSION)?1:0;if("truecolor"===g.COLORTERM)return 3;if("xterm-kitty"===g.TERM)return 3;if("TERM_PROGRAM"in g){const e=Number.parseInt((g.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(g.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(g.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(g.TERM)||"COLORTERM"in g?1:i}function p(e,o={}){return function(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}(d(e,{streamIsTTY:e&&e.isTTY,...o}))}f("no-color")||f("no-colors")||f("color=false")||f("color=never")?b=0:(f("color")||f("colors")||f("color=true")||f("color=always"))&&(b=1);const h={stdout:p({isTTY:n.isatty(1)}),stderr:p({isTTY:n.isatty(2)})};function m(e,o,n){let t=e.indexOf(o);if(-1===t)return e;const r=o.length;let s=0,c="";do{c+=e.slice(s,t)+o+n,s=t+r,t=e.indexOf(o,s)}while(-1!==t);return c+=e.slice(s),c}const{stdout:v,stderr:O}=h,$=Symbol("GENERATOR"),R=Symbol("STYLER"),T=Symbol("IS_EMPTY"),y=["ansi","ansi","ansi256","ansi16m"],E=Object.create(null),w=e=>{const o=(...e)=>e.join(" ");return((e,o={})=>{if(o.level&&!(Number.isInteger(o.level)&&o.level>=0&&o.level<=3))throw new Error("The `level` option should be an integer from 0 to 3");const n=v?v.level:0;e.level=void 0===o.level?n:o.level})(o,e),Object.setPrototypeOf(o,x.prototype),o};function x(e){return w(e)}Object.setPrototypeOf(x.prototype,Function.prototype);for(const[e,o]of Object.entries(u))E[e]={get(){const n=B(this,M(o.open,o.close,this[R]),this[T]);return Object.defineProperty(this,e,{value:n}),n}};E.visible={get(){const e=B(this,this[R],!0);return Object.defineProperty(this,"visible",{value:e}),e}};const j=(e,o,n,...t)=>"rgb"===e?"ansi16m"===o?u[n].ansi16m(...t):"ansi256"===o?u[n].ansi256(u.rgbToAnsi256(...t)):u[n].ansi(u.rgbToAnsi(...t)):"hex"===e?j("rgb",o,n,...u.hexToRgb(...t)):u[n][e](...t),A=["rgb","hex","ansi256"];for(const e of A){E[e]={get(){const{level:o}=this;return function(...n){const t=M(j(e,y[o],"color",...n),u.color.close,this[R]);return B(this,t,this[T])}}};E["bg"+e[0].toUpperCase()+e.slice(1)]={get(){const{level:o}=this;return function(...n){const t=M(j(e,y[o],"bgColor",...n),u.bgColor.close,this[R]);return B(this,t,this[T])}}}}const C=Object.defineProperties((()=>{}),{...E,level:{enumerable:!0,get(){return this[$].level},set(e){this[$].level=e}}}),M=(e,o,n)=>{let t,r;return void 0===n?(t=e,r=o):(t=n.openAll+e,r=o+n.closeAll),{open:e,close:o,openAll:t,closeAll:r,parent:n}},B=(e,o,n)=>{const t=(...e)=>I(t,1===e.length?""+e[0]:e.join(" "));return Object.setPrototypeOf(t,C),t[$]=e,t[R]=o,t[T]=n,t},I=(e,o)=>{if(e.level<=0||!o)return e[T]?"":o;let n=e[R];if(void 0===n)return o;const{openAll:t,closeAll:r}=n;if(o.includes(""))for(;void 0!==n;)o=m(o,n.close,n.open),n=n.parent;const s=o.indexOf("\n");return-1!==s&&(o=function(e,o,n,t){let r=0,s="";do{const c="\r"===e[t-1];s+=e.slice(r,c?t-1:t)+o+(c?"\r\n":"\n")+n,r=t+1,t=e.indexOf("\n",r)}while(-1!==t);return s+=e.slice(r),s}(o,r,t,s)),t+o+r};Object.defineProperties(x.prototype,E);const N=x();x({level:O?O.level:0});N.yellowBright('\n oooooooooooo \nd\'""""""d888\' \n      .888P   \n     d888\'    \n   .888P      \n  d888\'    .P \n.8888888888P\n');const P=e=>{if("string"==typeof e)return e;let o="";for(const[t,r]of Object.entries(e))o+=`\n    ${n=t,n.replace(/[A-Z]/g,(e=>`-${e.toLowerCase()}`))}: ${r};`;var n;return o};let _=null,S=null;const k=e=>{const o=(e=>{const o=e?.presets,n=e?.extend;if(!o)return{classNames:new Set,variants:new Set};const t=new Set,r=new Set;if(n?.fonts)for(const[e,o]of Object.entries(n?.fonts))t.add([new RegExp(`font-${e}`),`font-family: ${o.join(", ")}`]);if(n?.colors)for(const[e,o]of Object.entries(n?.colors))if("string"!=typeof o)for(const n of Object.keys(o))t.add([new RegExp(`color-${e}-${n}`),`color: ${o[n]}`]),t.add([new RegExp(`bg-${e}-${n}`),`background-color: ${o[n]}`]),t.add([new RegExp(`border-${e}-${n}`),`border-color: ${o[n]}`]);else t.add([new RegExp(`color-${e}`),`color: ${o}`]),t.add([new RegExp(`bg-${e}`),`background-color: ${o}`]),t.add([new RegExp(`border-${e}`),`border-color: ${o}`]);if(n?.rules)for(const e of Object.values(n?.rules)){const{match:o}=e;t.add([o,e])}for(const e of o){const{rules:o,colors:n,variants:s}=e;if(s)for(const e of Object.values(s)){const{match:o}=e;r.add([o,e])}for(const e of Object.values(o)){const{match:o}=e;t.add([o,e])}for(const[e,o]of Object.entries(n))if("string"!=typeof o)for(const n of Object.keys(o))t.add([new RegExp(`color-${e}-${n}`),`color: ${o[n]}`]),t.add([new RegExp(`bg-${e}-${n}`),`background-color: ${o[n]}`]),t.add([new RegExp(`border-${e}-${n}`),`border-color: ${o[n]}`]);else t.add([new RegExp(`color-${e}`),`color: ${o}`]),t.add([new RegExp(`bg-${e}`),`background-color: ${o}`]),t.add([new RegExp(`border-${e}`),`border-color: ${o}`])}return{classNames:t,variants:r}})(e);_=o.classNames,S=o.variants};const L=e=>e.replace(/([^\w_-])/g,"\\$1");var Y=async(e,o,n)=>{const t=await(async(e,o)=>{_&&S||k(e);const n=new Set;for(const[e,t]of _){const r=new RegExp(`(?:(\\w+):)?${s(e.source)}`,"g"),c=o.match(r);if(c)for(const o of c){const r=o.match(new RegExp(`(?:(\\w+):)?${s(e.source)}`)),c=r?.[1];if(c){const e=Array.from(S).find((([e])=>e===c));if(e){const[o,s]=e;n.add([r[0],s,t,...r.slice(2)]);continue}}Array.from(n).some((([e])=>e===r[0]))||r&&n.add([r[0],void 0,t,...r.slice(2)])}}return n})(e,o);let r=n?[]:"";var c;console.log((c=`Detected ${t.size} zephra class${1===t.size?"":"es"}`,N.blueBright("zephra: ".concat(c))));for(const[o,n,s,...c]of t){if(n){const{generate:t}=n;if("string"==typeof s){const{append:i,css:l}=t(e,o,s,...c);if("object"==typeof r){r.push({className:o,append:i,variant:n,css:l});continue}r+=`\n.${L(o)+i} {\n    ${l}\n}\n`;continue}const i=s.generate(e,o,...c),{append:l,css:a}=t(e,o,i,...c);if("object"==typeof r){r.push({className:o,append:l,variant:n,css:a});continue}r+=`\n.${L(o)+l} {\n    ${P(a)}\n}\n`;continue}if("string"==typeof s){"object"==typeof r?r.push({className:o,css:s}):r+=`\n.${o} {\n    ${s}\n}\n`;continue}const{generate:t}=s;"object"!=typeof r?r+=`\n.${L(o)} {${P(t(e,o,...c))}\n}\n`:r.push({className:o,variant:s,css:t(e,o,...c)})}return"object"==typeof r?r:e?.minify?r.replace(/\n/g,"").replace(/\s\s+/g," "):r};const G=e=>e;export{Y as build,Y as default,G as defineConfig,k as recomputeClassNames};
